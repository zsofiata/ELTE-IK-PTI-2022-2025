<!DOCTYPE html>
<html>
<head>
<title>12_feladat_minesweeper_model_only.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h4 id="az-utols%C3%B3-feladat-a-jelenlegi-eszk%C3%B6zeinkkel-m%C3%A1r-egy-eg%C3%A9sz-j%C3%A1t%C3%A9kot-lehet-implement%C3%A1lni-feladatunk-egy-teljes-aknakeres%C5%91-j%C3%A1t%C3%A9kot-k%C3%A9sz%C3%ADteni-a-feladatokat-b%C3%A1rmilyen-m%C3%B3don-meg-lehet-csin%C3%A1lni-magasabb-rend%C5%B1-f%C3%BCggv%C3%A9ny-rekurzi%C3%B3-listagener%C3%A1tor-amelyik-tetszik-hacsak-az-adott-feladat-sz%C3%B6vege-m%C3%A1sk%C3%A9pp-nem-rendelkezik-a-j%C3%A1t%C3%A9k-konzolb%C3%B3l-j%C3%A1tszhat%C3%B3-lesz">Az utolsó feladat! A jelenlegi eszközeinkkel már egy egész játékot lehet implementálni. Feladatunk egy teljes aknakereső játékot készíteni. A feladatokat bármilyen módon meg lehet csinálni, magasabb rendű függvény, rekurzió, listagenerátor, amelyik tetszik (hacsak az adott feladat szövege másképp nem rendelkezik). A játék konzolból játszható lesz!</h4>
<h4 id="a-feladatok-megold%C3%A1sa-sor%C3%A1n-ne-haszn%C3%A1ljunk-parci%C3%A1lis-f%C3%BCggv%C3%A9nyeket">A feladatok megoldása során <strong>NE</strong> használjunk parciális függvényeket.</h4>
<h2 id="0-modul-l%C3%A9trehoz%C3%A1sa-%C3%A9s-mappaszerkezet-l%C3%A9trehoz%C3%A1sa">0. Modul létrehozása és mappaszerkezet létrehozása</h2>
<p>Hozz létre egy új mappát <code>MineSweeper</code> néven. Ebbe a mappába kell majd az összes kódot pakolni, majd mappán kívülről lehet betölteni a kódot.
Hozz létre egy modult <code>MineSweeper.Model</code> néven!</p>
<p>Hozd létre az alábbi 3 fájlt a <code>MineSweeper</code> mappán belül a nekik megadott megfelelő néven.</p>
<p><code>FieldNumber.hs</code></p>
<pre class="hljs"><code><div><span class="hljs-keyword">module</span> MineSweeper.FieldNumber (<span class="hljs-type">FieldNumber</span>, <span class="hljs-title">fieldNumber</span>, <span class="hljs-title">getFieldNumber</span>) <span class="hljs-keyword">where</span>

<span class="hljs-keyword">import</span> Data.Function (<span class="hljs-title">on</span>)
<span class="hljs-keyword">import</span> Data.List (<span class="hljs-title">minimumBy</span>)

<span class="hljs-class"><span class="hljs-keyword">newtype</span> <span class="hljs-type">FieldNumber</span> = <span class="hljs-type">FieldNumber</span> {<span class="hljs-title">getFieldNumber</span> :: <span class="hljs-type">Int</span>} <span class="hljs-keyword">deriving</span> (<span class="hljs-type">Eq</span>, <span class="hljs-type">Ord</span>)</span>
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Bounded</span> <span class="hljs-type">FieldNumber</span> <span class="hljs-keyword">where</span></span>
    minBound = <span class="hljs-type">FieldNumber</span> <span class="hljs-number">0</span>
    maxBound = <span class="hljs-type">FieldNumber</span> <span class="hljs-number">8</span>
<span class="hljs-class">    
<span class="hljs-keyword">instance</span> <span class="hljs-type">Enum</span> <span class="hljs-type">FieldNumber</span> <span class="hljs-keyword">where</span></span>
    succ (<span class="hljs-type">FieldNumber</span> int) = fieldNumber $ succ int
    pred (<span class="hljs-type">FieldNumber</span> int) = fieldNumber $ pred int
    toEnum = fieldNumber
    fromEnum (<span class="hljs-type">FieldNumber</span> int) = int
    enumFrom (<span class="hljs-type">FieldNumber</span> start) = map fieldNumber $ enumFromThenTo start (succ start) <span class="hljs-number">8</span>
    enumFromThen (<span class="hljs-type">FieldNumber</span> start) (<span class="hljs-type">FieldNumber</span> next) = map fieldNumber $ enumFromThenTo start next $ fst $ minimumBy (compare `on` snd) [(<span class="hljs-number">0</span>, next), (<span class="hljs-number">8</span>, start)]
    enumFromTo (<span class="hljs-type">FieldNumber</span> start) (<span class="hljs-type">FieldNumber</span> end) = map fieldNumber $ enumFromThenTo start (succ start) end
    enumFromThenTo (<span class="hljs-type">FieldNumber</span> start) (<span class="hljs-type">FieldNumber</span> next) (<span class="hljs-type">FieldNumber</span> end) = map fieldNumber $ enumFromThenTo start next (min <span class="hljs-number">8</span> end)
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Show</span> <span class="hljs-type">FieldNumber</span> <span class="hljs-keyword">where</span></span>
    showsPrec prec (<span class="hljs-type">FieldNumber</span> integer) = showsPrec prec integer
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Read</span> <span class="hljs-type">FieldNumber</span> <span class="hljs-keyword">where</span></span>
    readsPrec prec str = map (first fromInteger) (readsPrec prec str) <span class="hljs-keyword">where</span>
        first :: (val -&gt; val') -&gt; (val,other) -&gt; (val',other)
        first f (val, other) = (f val, other)
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Num</span> <span class="hljs-type">FieldNumber</span> <span class="hljs-keyword">where</span></span>
    <span class="hljs-type">FieldNumber</span> int1 + <span class="hljs-type">FieldNumber</span> int2 
        | <span class="hljs-number">0</span> &lt;= x &amp;&amp; x &lt;= <span class="hljs-number">8</span> = <span class="hljs-type">FieldNumber</span> x
        | otherwise = errorWithoutStackTrace <span class="hljs-string">"FieldNumber.(+): The sum of the two numbers exceeds 8!"</span>
        <span class="hljs-keyword">where</span> x = int1 + int2
    <span class="hljs-type">FieldNumber</span> int1 - <span class="hljs-type">FieldNumber</span> int2
        | <span class="hljs-number">0</span> &lt;= x &amp;&amp; x &lt;= <span class="hljs-number">8</span> = <span class="hljs-type">FieldNumber</span> x
        | otherwise = errorWithoutStackTrace <span class="hljs-string">"FieldNumber.(-): The difference of the two numbers subceeds 0!"</span>
        <span class="hljs-keyword">where</span> x = int1 - int2
    <span class="hljs-type">FieldNumber</span> int1 * <span class="hljs-type">FieldNumber</span> int2
        | <span class="hljs-number">0</span> &lt;= x &amp;&amp; x &lt;= <span class="hljs-number">8</span> = <span class="hljs-type">FieldNumber</span> x
        | otherwise = errorWithoutStackTrace <span class="hljs-string">"FieldNumber.(*): The product of the two numbers exceeds 8!"</span>
        <span class="hljs-keyword">where</span> x = int1 * int2
    abs = id
    signum x@(<span class="hljs-type">FieldNumber</span> <span class="hljs-number">0</span>) = x
    signum _ = <span class="hljs-type">FieldNumber</span> <span class="hljs-number">1</span>
    fromInteger = fieldNumber . fromIntegral
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Real</span> <span class="hljs-type">FieldNumber</span> <span class="hljs-keyword">where</span></span>
    toRational = toRational . toInteger

<span class="hljs-title">fieldNumber</span> :: <span class="hljs-type">Int</span> -&gt; <span class="hljs-type">FieldNumber</span>
<span class="hljs-title">fieldNumber</span> i
    | i `elem` [<span class="hljs-number">0.</span><span class="hljs-number">.8</span>] = <span class="hljs-type">FieldNumber</span> i
    | otherwise = errorWithoutStackTrace <span class="hljs-string">"FieldNumber: FieldNumber can only be from [0..8]!"</span>
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Integral</span> <span class="hljs-type">FieldNumber</span> <span class="hljs-keyword">where</span></span>
    quotRem (<span class="hljs-type">FieldNumber</span> int1) (<span class="hljs-type">FieldNumber</span> int2) = <span class="hljs-keyword">let</span> (quot,rem) = quotRem int1 int2 <span class="hljs-keyword">in</span> (fieldNumber quot, fieldNumber rem)
    divMod (<span class="hljs-type">FieldNumber</span> int1) (<span class="hljs-type">FieldNumber</span> int2) = <span class="hljs-keyword">let</span> (quot,rem) = divMod int1 int2 <span class="hljs-keyword">in</span> (fieldNumber quot, fieldNumber rem)
    toInteger (<span class="hljs-type">FieldNumber</span> int) = toInteger int
</div></code></pre>
<hr>
<p><code>RandomPositionGenerator.hs</code></p>
<pre class="hljs"><code><div><span class="hljs-keyword">module</span> MineSweeper.RandomPositionGenerator <span class="hljs-keyword">where</span>

<span class="hljs-keyword">import</span> System.Random ( <span class="hljs-title">mkStdGen</span>, <span class="hljs-type">Random(..)</span> )

<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-type">Seed</span> = <span class="hljs-type">Int</span></span>

<span class="hljs-title">generatePosition</span> :: <span class="hljs-type">Seed</span> -&gt; (<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>)
<span class="hljs-title">generatePosition</span> = fst . random . mkStdGen

<span class="hljs-title">generatePositions</span> :: <span class="hljs-type">Seed</span> -&gt; [(<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>)]
<span class="hljs-title">generatePositions</span> = randoms . mkStdGen

<span class="hljs-title">generatePositionR</span> :: ((<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>), (<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>)) -&gt; <span class="hljs-type">Seed</span> -&gt; (<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>)
<span class="hljs-title">generatePositionR</span> a = fst . randomR a . mkStdGen

<span class="hljs-title">generatePositionRs</span> :: ((<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>), (<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>)) -&gt; <span class="hljs-type">Seed</span> -&gt; [(<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>)]
<span class="hljs-title">generatePositionRs</span> a = randomRs a . mkStdGen
</div></code></pre>
<hr>
<p><code>ConsoleView.hs</code></p>
<pre class="hljs"><code><div><span class="hljs-keyword">module</span> MineSweeper.ConsoleView <span class="hljs-keyword">where</span>

<span class="hljs-keyword">import</span> System.Random ( <span class="hljs-title">randomIO</span> )
<span class="hljs-keyword">import</span> System.IO ( <span class="hljs-title">stdout</span>, <span class="hljs-title">hFlush</span> )
<span class="hljs-keyword">import</span> MineSweeper.Model
    ( startNewGame
    , stepGame
    , <span class="hljs-type">Board</span>(<span class="hljs-type">Board</span>)
    , <span class="hljs-type">Field</span>(<span class="hljs-type">Flagged</span>, <span class="hljs-type">Closed</span>, <span class="hljs-type">Opened</span>)
    , <span class="hljs-type">FieldType</span>(..)
    , <span class="hljs-type">Game</span>(<span class="hljs-type">Game</span>)
    , gameState
    , <span class="hljs-type">MoveType</span>(..)
    , <span class="hljs-type">State</span>(..) )
<span class="hljs-keyword">import</span> Text.Read ( <span class="hljs-title">readMaybe</span> )
<span class="hljs-keyword">import</span> Data.List ( <span class="hljs-title">intercalate</span> )
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Show</span> <span class="hljs-type">FieldType</span> <span class="hljs-keyword">where</span></span>
    show <span class="hljs-type">Mine</span> = <span class="hljs-string">"X"</span>
    show (<span class="hljs-type">Free</span> x) = show x
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Show</span> <span class="hljs-type">Field</span> <span class="hljs-keyword">where</span></span>
    show (<span class="hljs-type">Closed</span> _) = <span class="hljs-string">"_"</span>
    show (<span class="hljs-type">Opened</span> x) = show x
    show (<span class="hljs-type">Flagged</span> _) = <span class="hljs-string">"F"</span>
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Show</span> <span class="hljs-type">Board</span> <span class="hljs-keyword">where</span></span>
    show (<span class="hljs-type">Board</span> _ _ x) = intercalate <span class="hljs-string">"\n"</span> $ map (intercalate <span class="hljs-string">"|"</span> . map show) x
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Show</span> <span class="hljs-type">State</span> <span class="hljs-keyword">where</span></span>
    show <span class="hljs-type">Running</span> = <span class="hljs-string">""</span>
    show (<span class="hljs-type">GameOver</span> p)
        | p           = <span class="hljs-string">"Nyertél!"</span>
        | otherwise   = <span class="hljs-string">"Vesztettél! Bombát nyitottál!"</span>
<span class="hljs-class">
<span class="hljs-keyword">instance</span> <span class="hljs-type">Show</span> <span class="hljs-type">Game</span> <span class="hljs-keyword">where</span></span>
    show (<span class="hljs-type">Game</span> b s) = intercalate <span class="hljs-string">"\n"</span> [show b, show s]

<span class="hljs-title">iterateUntilM</span> :: (<span class="hljs-type">Monad</span> m) =&gt; (a -&gt; <span class="hljs-type">Bool</span>) -&gt; (a -&gt; m a) -&gt; a -&gt; m a
<span class="hljs-title">iterateUntilM</span> p f v 
    | p v       = return v
    | otherwise = f v &gt;&gt;= iterateUntilM p f

<span class="hljs-title">putStr'</span> :: <span class="hljs-type">String</span> -&gt; <span class="hljs-type">IO</span> ()
<span class="hljs-title">putStr'</span> str = putStr str &gt;&gt; hFlush stdout

<span class="hljs-title">prompt</span> :: <span class="hljs-type">Read</span> a =&gt; <span class="hljs-type">String</span> -&gt; <span class="hljs-type">IO</span> a
<span class="hljs-title">prompt</span> str = putStr' str &gt;&gt; getReadable

<span class="hljs-title">getReadable</span> :: <span class="hljs-type">Read</span> a =&gt; <span class="hljs-type">IO</span> a
<span class="hljs-title">getReadable</span> = <span class="hljs-keyword">do</span>
        input &lt;- getLine
        <span class="hljs-keyword">case</span> readMaybe input <span class="hljs-keyword">of</span>
            <span class="hljs-type">Nothing</span> -&gt; putStrLn <span class="hljs-string">"Nem megfelelő típus! Próbálja újra!"</span> &gt;&gt; getReadable
            <span class="hljs-type">Just</span> x -&gt; return x

<span class="hljs-title">readMaybeMoveType</span> :: <span class="hljs-type">String</span> -&gt; <span class="hljs-type">Maybe</span> <span class="hljs-type">MoveType</span>
<span class="hljs-title">readMaybeMoveType</span> str = <span class="hljs-keyword">case</span> words str <span class="hljs-keyword">of</span>
    <span class="hljs-string">"F"</span>:xs@[_,_] -&gt; <span class="hljs-keyword">case</span> map readMaybe xs :: [<span class="hljs-type">Maybe</span> <span class="hljs-type">Int</span>] <span class="hljs-keyword">of</span>
        [<span class="hljs-type">Just</span> a, <span class="hljs-type">Just</span> b] -&gt; <span class="hljs-type">Just</span> $ <span class="hljs-type">Flag</span> (a, b)
        _ -&gt; <span class="hljs-type">Nothing</span>
    xs@[_,_] -&gt; <span class="hljs-keyword">case</span> map readMaybe xs :: [<span class="hljs-type">Maybe</span> <span class="hljs-type">Int</span>] <span class="hljs-keyword">of</span>
        [<span class="hljs-type">Just</span> a, <span class="hljs-type">Just</span> b] -&gt; <span class="hljs-type">Just</span> $ <span class="hljs-type">Open</span> (a, b)
        _ -&gt; <span class="hljs-type">Nothing</span>
    _ -&gt; <span class="hljs-type">Nothing</span>

<span class="hljs-title">main</span> :: <span class="hljs-type">IO</span> ()
<span class="hljs-title">main</span> = <span class="hljs-keyword">do</span>
    seed &lt;- randomIO :: <span class="hljs-type">IO</span> <span class="hljs-type">Int</span>
    w &lt;- prompt <span class="hljs-string">"Adja meg a tábla szélességét: "</span> :: <span class="hljs-type">IO</span> <span class="hljs-type">Int</span>
    h &lt;- prompt <span class="hljs-string">"Adja meg a tábla magasságát: "</span> :: <span class="hljs-type">IO</span> <span class="hljs-type">Int</span>
    b &lt;- prompt <span class="hljs-string">"Adja meg a bombák számát!\n(Tábla méretének 10%-a és 50%-a között lesz a bombák száma): "</span> :: <span class="hljs-type">IO</span> <span class="hljs-type">Int</span>
    <span class="hljs-keyword">let</span> initGame = startNewGame w h b seed
    print initGame
    iterateUntilM (\game -&gt; <span class="hljs-keyword">case</span> gameState game <span class="hljs-keyword">of</span> <span class="hljs-type">Running</span> -&gt; <span class="hljs-type">False</span>; _ -&gt; <span class="hljs-type">True</span>) (\game -&gt; <span class="hljs-keyword">do</span>
        move &lt;- getLine
        <span class="hljs-keyword">case</span> readMaybeMoveType move <span class="hljs-keyword">of</span>
            <span class="hljs-type">Just</span> x -&gt; <span class="hljs-keyword">do</span> 
                <span class="hljs-keyword">let</span> next = stepGame game x
                print next
                return next
            _ -&gt; <span class="hljs-keyword">do</span>
                putStrLn <span class="hljs-string">"Nem megfelelő beviteli formátum!"</span>
                print game
                return game
        ) initGame
    return ()
</div></code></pre>
<p><em>Használati útmutató:</em> Ha a játék kész lesz, akkor a <code>MineSweeper.ConsolView</code> modult importálva és a <code>main</code> függvényt futtatva lehet a játékot futtatni a ghci-ben. A fájlok betöltése kicsit körülményes. Ha van egy alapértelmezett mappád, ahol a ghci mindig indul és azon belül hoztad létre a <code>MineSweeper</code> mappát, akkor a legegyszerűbb, ekkor a ghci-ben csak <code>:l MineSweeper\ConsoleView.hs</code> parancsot kell kiadni. Ha valahol máshol indul a ghci, akkor a ghci-n belül a <code>:cd</code> parancs használatával a cmd-vel és mac és linux terminállal azonos módon el lehet navigálni odáig, ahol a <code>MineSweeper</code> mappa található és akkor lehet használni az előbbi <code>:l</code>-es kommandot. Vagy (bár ezt nem próbáltam ki) megadjuk a <code>:l</code>-nek a 4 betöltendő fájl abszolút útvonalát szóközökkel elválasztva és talán megy, de erre garanciát nem adok.</p>
<p><strong>FIGYELEM!</strong> A RandomPositionGenerator.hs-ben van egy <code>import System.Random</code>-mal kezdődő sor. Ez a modul nem tartozik alapból a nyelvhez és a ghc telepítésekor egyik csomagban sincs benne. Ezt külön telepíteni kell. Nyissunk megy egy kedvenc konzolt vagy terminált operációs rendszertől függően. Két parancsot kell kiadni:</p>
<ul>
<li><code>cabal v1-update</code>; várjuk meg, amíg ez befejezi a működését.</li>
<li><code>cabal v1-install random</code></li>
</ul>
<p>Ha sikerült ezt jól megtenni, akkor újranyitva a ghci-t a <code>System.Random</code> modul használható.</p>
<h2 id="1-t%C3%ADpusszinon%C3%ADm%C3%A1k">1. Típusszinonímák</h2>
<p>Definiálj három típusszinonímát az alábbi neveken:</p>
<ul>
<li><code>Width</code></li>
<li><code>Height</code></li>
<li><code>NumberOfBombs</code></li>
</ul>
<p>Mindhárom legyen szinonímája az <code>Int</code> típusnak. Az első a tábla szélességét, a második a tábla magasságát, a harmadik a bombák számát jelöli.</p>
<h2 id="2a-saj%C3%A1t-t%C3%ADpusok">2a. Saját típusok</h2>
<p>Hozd létre az alábbi típusokat, amivel fogjuk tudni kezelni a játék menetét:</p>
<ul>
<li><code>FieldType</code>: Ezzel jelöljük, hogy egy mező számos vagy bombát tartalmaz. Legyen két konstruktora:
<ul>
<li><code>Mine :: FieldType</code>: A mező bombát tartalmaz.</li>
<li><code>Free :: FieldNumber -&gt; FieldType</code>: A mező számot tartalmaz. A <code>FieldNumber</code> típus a <code>MineSweeper.FieldNumber</code> modulban található.</li>
</ul>
</li>
<li><code>Field</code>: Ezen típus értékeiből tudjuk kideríteni, hogy egy mező milyen állapotban van. Három állapot lehetséges, így azok legyenek a konstruktorok:
<ul>
<li><code>Closed :: FieldType -&gt; Field</code>: Még nem nyitottuk ki a mezőt és nincs rajta bombát jelölő zászló.</li>
<li><code>Opened :: FieldType -&gt; Field</code>: Nyitott mező.</li>
<li><code>Flagged :: FieldType -&gt; Field</code>: Még nem nyitott mező bombát jelölő zászlóval.
Mindhárom tartalmazza, hogy konkrétan mi van a mezőn.</li>
</ul>
</li>
<li><code>Board</code>: Ebben a struktúrában tároljuk a táblánkat és a hozzá tartozó adatokat. Az egyetlen konstruktor neve ugyanez legyen, amelynek a típusa <code>Board :: Width -&gt; Height -&gt; [[Field]] -&gt; Board</code></li>
<li><code>State</code> : Ezzel tartjuk számon, hogy a játék folyik-e még vagy már vége van és hogy mi lett az eredmény. Épp ezért ennek két konstruktora lesz:
<ul>
<li><code>Running :: State</code>, amely jelzi, hogy a játék még tart.</li>
<li><code>GameOver :: Bool -&gt; State</code>, amelyben eltároljuk azt, hogy a játékos nyert-e a játék végén.</li>
</ul>
</li>
<li><code>Game</code> : Ez fogja az egész játékállást tárolni, valamennyi lépésben ezt az állapotot kell változtatni. Legyen egy <code>Game :: Board -&gt; State -&gt; Game</code> konstruktora, amely tartalmazza a táblát, illetve az állapotot, hogy a játék megy még vagy már vége van-e.</li>
</ul>
<p>A fordítótól nem kérhetünk segítséget, illetve <code>Eq</code>, <code>Enum</code> példányt ebben a fájlban definiált saját típusra sem lehet megadni, tessék mintaillesztést használni!</p>
<h2 id="2b-getter-f%C3%BCggv%C3%A9nyek">2b. Getter függvények</h2>
<p>Definiáld a fenti <code>Board</code> és <code>Game</code> típusokhoz a getter függvényeket.</p>
<ul>
<li><code>getWidth :: Board -&gt; Width</code> : Visszaadja a <code>Board</code> konstruktornak a <code>Width</code> típusú paraméterét.</li>
<li><code>getHeight :: Board -&gt; Height</code> : Visszaadja a <code>Board</code> konstruktornak a <code>Height</code> típusú paraméterét.</li>
<li><code>getField :: Board -&gt; [[Field]]</code> : Visszaadja a <code>Board</code> konstruktornak a <code>[[Field]]</code> típusú paraméterét.</li>
<li><code>gameBoard :: Game -&gt; Board</code> : Visszaadja a <code>Game</code> konstruktornak a <code>Board</code> típusú paraméterét.</li>
<li><code>gameState :: Game -&gt; State</code> : Visszaadja a <code>Game</code> konstruktornak a <code>State</code> típusú paraméterét.</li>
</ul>
<h2 id="3a-biztons%C3%A1gos-indexel%C3%A9s">3a. Biztonságos indexelés</h2>
<p>Definiáljuk a <code>(!!?) :: [a] -&gt; Int -&gt; Maybe a</code> függvényt. A függvény <code>Nothing</code>-ot ad vissza, ha rosszul indexelünk a listába, egyébként <code>Just</code>-ban adjuk vissza az eredményt.</p>
<pre class="hljs"><code><div>[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">12</span>,<span class="hljs-number">33</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>] !!? <span class="hljs-number">5</span> == <span class="hljs-type">Just</span> <span class="hljs-number">12</span>
[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">12</span>,<span class="hljs-number">33</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>] !!? <span class="hljs-number">0</span> == <span class="hljs-type">Just</span> <span class="hljs-number">1</span>
[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">12</span>,<span class="hljs-number">33</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>] !!? (<span class="hljs-number">-1</span>) == <span class="hljs-type">Nothing</span>
[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">12</span>,<span class="hljs-number">33</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>] !!? <span class="hljs-number">9</span> == <span class="hljs-type">Nothing</span>
[] !!? <span class="hljs-number">5</span> == <span class="hljs-type">Nothing</span>
<span class="hljs-string">"alma"</span> !!? <span class="hljs-number">2</span> == <span class="hljs-type">Just</span> 'm'
<span class="hljs-string">"alma"</span> !!? <span class="hljs-number">3</span> == <span class="hljs-type">Just</span> 'a'
<span class="hljs-string">"alma"</span> !!? <span class="hljs-number">4</span> == <span class="hljs-type">Nothing</span>
<span class="hljs-string">"alma"</span> !!? (<span class="hljs-number">-10</span>) == <span class="hljs-type">Nothing</span>
</div></code></pre>
<h2 id="3b-maybe-n-bel%C3%BCli-%C3%A9rt%C3%A9k">3b. <code>Maybe</code>-n belüli érték</h2>
<p>Definiáljuk a <code>maybeMap :: (a -&gt; b) -&gt; (Maybe a -&gt; Maybe b)</code> függvényt, amely egy függvényt átalakít olyan függvénnyé, amely <code>Maybe a</code> értékeken végzi el a műveletet.</p>
<pre class="hljs"><code><div><span class="hljs-title">maybeMap</span> (+<span class="hljs-number">1</span>) (<span class="hljs-type">Just</span> <span class="hljs-number">1</span>) == <span class="hljs-type">Just</span> <span class="hljs-number">2</span>
<span class="hljs-title">maybeMap</span> (+<span class="hljs-number">1</span>) <span class="hljs-type">Nothing</span> == <span class="hljs-type">Nothing</span>
<span class="hljs-title">maybeMap</span> (take <span class="hljs-number">1</span>) (<span class="hljs-type">Just</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]) == <span class="hljs-type">Just</span> [<span class="hljs-number">1</span>]
<span class="hljs-title">maybeMap</span> (take <span class="hljs-number">1</span>) (<span class="hljs-type">Just</span> []) == <span class="hljs-type">Just</span> []
</div></code></pre>
<h2 id="3c-t%C3%B6bb-maybe-%C3%B6sszevon%C3%A1sa">3c. Több <code>Maybe</code> összevonása</h2>
<p>Definiáljuk a <code>joinMaybe :: Maybe (Maybe a) -&gt; Maybe a</code> függvényt, amellyel két <code>Maybe</code>-t lehet eggyé összevonni. Csak akkor lesz értékünk, ha mindkét <code>Maybe</code> a <code>Just</code> konstruktorral van definiálva, tehát van konkrét értékünk, ellenkező esetben <code>Nothing</code>.</p>
<pre class="hljs"><code><div><span class="hljs-title">joinMaybe</span> (<span class="hljs-type">Just</span> (<span class="hljs-type">Just</span> <span class="hljs-number">1</span>)) == <span class="hljs-type">Just</span> <span class="hljs-number">1</span>
<span class="hljs-title">joinMaybe</span> (<span class="hljs-type">Just</span> (<span class="hljs-type">Just</span> [<span class="hljs-number">1</span>])) == <span class="hljs-type">Just</span> [<span class="hljs-number">1</span>]
<span class="hljs-title">joinMaybe</span> (<span class="hljs-type">Just</span> (<span class="hljs-type">Just</span> <span class="hljs-string">"alma"</span>)) == <span class="hljs-type">Just</span> <span class="hljs-string">"alma"</span>
<span class="hljs-title">joinMaybe</span> (<span class="hljs-type">Just</span> (<span class="hljs-type">Just</span> 'a')) == <span class="hljs-type">Just</span> 'a'
<span class="hljs-title">joinMaybe</span> (<span class="hljs-type">Just</span> <span class="hljs-type">Nothing</span>) == <span class="hljs-type">Nothing</span>
<span class="hljs-title">joinMaybe</span> <span class="hljs-type">Nothing</span> == <span class="hljs-type">Nothing</span>
</div></code></pre>
<h2 id="4-egy%C3%A9rtelm%C5%B1-medi%C3%A1n-sz%C3%A1mol%C3%A1sa">4. Egyértelmű medián számolása</h2>
<p>Számoljuk ki egy lista mediánját a <code>singleMedian :: Ord a =&gt; [a] -&gt; Maybe a</code>. Egyértelmű medián szükséges nekünk, így akkor is adjunk vissza <code>Nothing</code>-ot, ha a medián a két középső elem átlagának kiszámolásából jönne ki. Ezzel a függvénnyel lesz egyszerű megoldani a szükséges későbbi kikötéseket, hogy hány akna lehet a táblán. Egy rendezett adatsor mediánja annak a középső eleme. Pl. medián [6,5,9,1,0,2,8] -&gt; rendezzük az adatokat -&gt; medián [0,1,2,5,6,8,9] == 5, az a 4. elem balról és jobbról is egy 7 elemű adatsorból, tehát az a középső.</p>
<p><em>Segítség:</em> A függvényhez definiáljunk egy segédfüggvényt, amelynek adjuk át kétszer a rendezett listát. Az egyik listán lépkedjünk egyesével, a másikban kettesével.</p>
<ul>
<li>Ha az, amelyikben kettesével lépkedtünk, elért egy pontosan egy elemű listáig, akkor a másikban az első elem a medián, ekkor adjuk vissza azt.</li>
<li>Ha az, amelyikben kettesével lépkedtünk, elért egy pontosan két elemű listáig, akkor nincs egyértelmű medián.</li>
<li>Ha több elem van mindkét listában, akkor az egyiken lépjünk egyet, a másikon kettőt.</li>
<li>Ha valamelyik lista üres, akkor adjunk vissza <code>Nothing</code>-ot.</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-title">singleMedian</span> [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>] == <span class="hljs-type">Just</span> <span class="hljs-number">5</span>
<span class="hljs-title">singleMedian</span> [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>] == <span class="hljs-type">Nothing</span>
<span class="hljs-title">singleMedian</span> [] == <span class="hljs-type">Nothing</span>
<span class="hljs-title">singleMedian</span> <span class="hljs-string">"a"</span> == <span class="hljs-type">Just</span> 'a'
<span class="hljs-title">singleMedian</span> <span class="hljs-string">"alma"</span> == <span class="hljs-type">Nothing</span>
<span class="hljs-title">singleMedian</span> <span class="hljs-string">"körte"</span> == <span class="hljs-type">Just</span> 'r'
<span class="hljs-title">singleMedian</span> [<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>] == <span class="hljs-type">Just</span> <span class="hljs-number">7</span>
</div></code></pre>
<h2 id="5-rendezett-list%C3%A1ban-elem">5. Rendezett listában elem</h2>
<p>Definiáljuk a <code>sortedElem :: Ord a =&gt; a -&gt; [a] -&gt; Bool</code> függvényt, amely egy rendezett listában nézi meg, hogy egy adott elem benne van-e a listában. Ez annyitól lesz jobb, mint a sima <code>elem</code> függvény, hogy ha az elemünk nagyobb, mint ahol tartunk a vizsgálatban, akkor ott már rövidre lehet zárni a keresést. Ez akár végtelen listán is működik, pl. <code>sortedElem 0 [1..] == False</code> lesz és nem fog a végtelenségig dolgozni. Persze, ehhez fel kell tenni, hogy a lista rendezett.</p>
<pre class="hljs"><code><div><span class="hljs-title">not</span> $ sortedElem <span class="hljs-number">0</span> [<span class="hljs-number">1.</span>.]
<span class="hljs-title">sortedElem</span> <span class="hljs-number">10</span> [<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">13</span>]
<span class="hljs-title">sortedElem</span> 'k' <span class="hljs-string">"aaaabbbccddeefghijkllllmmmmmmzzzzzz"</span>
<span class="hljs-title">not</span> $ sortedElem <span class="hljs-number">10</span> [<span class="hljs-number">1</span>,<span class="hljs-number">3</span> ..]
</div></code></pre>
<h2 id="6-bomb%C3%A1k-hely%C3%A9nek-gener%C3%A1l%C3%A1sa">6. Bombák helyének generálása</h2>
<p>Definiáljuk a <code>generateBombsPositions :: Width -&gt; Height -&gt; NumberOfBombs -&gt; Seed -&gt; [(Int,Int)]</code> függvényt. Értelemszerűen kell egy adott táblára adott számú bomba, tehát annyi elemű listát adunk vissza. A listánk legyen rendezett a rendezett pár első, majd a második eleme alapján. A bombák száma minimum a tábla méretének 10%-a, de legfeljebb 50%-a. Tehát például egy 15x12-es táblára kell legalább 15x12/10 = 180/10 = 18 db bomba, de legfeljebb 90 bomba lehet. Ha a minimumnál kisebb értéket adunk át, akkor a bombák száma legyen a minimum. Ha maximumnál nagyobb értéket adunk át, akkor pedig legyen a maximum.</p>
<p><em>Segítség:</em> Használjuk fel a <code>generatePositionRs</code> függvényt, amely a <code>MineSweeper.RandomPositionGenerator</code>-ben található. A random elemek között lehet több azonos is, erre figyelni kell. A <code>Seed</code> típusszinoníma szintén az előbb definiált modulban található. Ezen paraméterre a tisztaság miatt van szükség. Azonos <code>Seed</code>-ek esetén nyilván azonos bombákat kapunk vissza.</p>
<pre class="hljs"><code><div><span class="hljs-title">generateBombsPositions</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">60</span> <span class="hljs-number">0</span> == [(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">6</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">6</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">8</span>)]
<span class="hljs-title">generateBombsPositions</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">50</span> <span class="hljs-number">0</span> == [(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">0</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">9</span>),(<span class="hljs-number">6</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">6</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">6</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">8</span>)]
<span class="hljs-title">generateBombsPositions</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">0</span> == [(<span class="hljs-number">0</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">7</span>)]
<span class="hljs-title">generateBombsPositions</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">1</span> == [(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">5</span>)]
<span class="hljs-title">generateBombsPositions</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> == [(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">5</span>)]
<span class="hljs-title">generateBombsPositions</span> <span class="hljs-number">6</span> <span class="hljs-number">6</span> <span class="hljs-number">10</span> <span class="hljs-number">1</span> == [(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">2</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">4</span>)]
</div></code></pre>
<h2 id="7-szomsz%C3%A9dos-mez%C5%91k">7. Szomszédos mezők</h2>
<p>Definiáljuk a <code>neighbours :: (Int,Int) -&gt; [[a]] -&gt; [[a]]</code> függvényt, amely visszaadja egy mezőhöz tartozó legfeljebb 8 szomszédos mezőt és önmagát. Szomszédnak a függőlegesen, vízszintesen és átlósan 1-1 mező távolságban lévő mezők számítanak. Listák tekintetében ez annyit jelent, hogy egy értéknek a szomszédja egy másik érték:</p>
<ul>
<li>ha azonos listán belül egymást követő elemek.</li>
<li>ha két egymást követő listában azonos helyen lévő elemek.</li>
<li>ha két egymást követő listában két egymást követő helyen lévő elemek.</li>
</ul>
<p>A tesztekből talán egyértelműbb, hogy mit kell csinálni.</p>
<pre class="hljs"><code><div><span class="hljs-title">neighbours</span> (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>], [<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]] == [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>], [<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]]
 <span class="hljs-comment">-- ebben az esetben az (1,1) helyen az 5-ös található, így mindegyik elem a szomszédja</span>
<span class="hljs-title">neighbours</span> (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>], [<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]] == [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]]
 <span class="hljs-comment">-- ebben az esetben az elemünk a 2-es, a 7,8,9 egyike sem szomszédja a 2-nek.</span>
<span class="hljs-title">neighbours</span> (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>], [<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>]] == [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]]
 <span class="hljs-comment">-- ebben az esetben az elemünk az 1-es, 3,6,7,8,9 nem szomszédja az 1-esnek.</span>
<span class="hljs-title">neighbours</span> (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], [<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>], [<span class="hljs-number">10</span>]] == [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>], [<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>]]
 <span class="hljs-comment">-- ebben az esetben az elemünk a 4-es, a 9 és 10-es nem szomszédok a 4-essel.</span>
</div></code></pre>
<p>A lista nyilván nem csak 3x3-as lehet, az se biztos, hogy egyáltalán mindegyik listák hosszai ugyanannyik.</p>
<h2 id="8-szomsz%C3%A9dos-bomb%C3%A1k">8. Szomszédos bombák</h2>
<p>Definiáljuk a <code>countNeighbouringBombs :: (Int, Int) -&gt; [(Int, Int)] -&gt; Int</code> függvényt, amely megkap egy pozíciót és a bombák helyének listáját. Számoljuk meg, hogy az adott mezőnek hány szomszédja bomba. A mezőt önmagát ne számoljuk bele akkor se, ha az bomba (nyilván egy mező nem szomszédos önmagával).</p>
<pre class="hljs"><code><div><span class="hljs-title">countNeighbouringBombs</span> (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) (generateBombsPositions <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>) == <span class="hljs-number">2</span>
<span class="hljs-title">countNeighbouringBombs</span> (<span class="hljs-number">8</span>,<span class="hljs-number">4</span>) (generateBombsPositions <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>) == <span class="hljs-number">3</span>
<span class="hljs-title">countNeighbouringBombs</span> (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) (generateBombsPositions <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>) == <span class="hljs-number">1</span>
<span class="hljs-title">countNeighbouringBombs</span> (<span class="hljs-number">7</span>,<span class="hljs-number">2</span>) (generateBombsPositions <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">50</span> <span class="hljs-number">1</span>) == <span class="hljs-number">7</span>
<span class="hljs-title">countNeighbouringBombs</span> (<span class="hljs-number">7</span>,<span class="hljs-number">5</span>) (generateBombsPositions <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">50</span> <span class="hljs-number">14</span>) == <span class="hljs-number">8</span>
</div></code></pre>
<h2 id="9-j%C3%A1t%C3%A9kt%C3%A1bla-elk%C3%A9sz%C3%ADt%C3%A9s">9. Játéktábla elkészítés</h2>
<p>Definiáljuk a <code>generateBoard :: Width -&gt; Height -&gt; [(Int, Int)] -&gt; Board</code> függvényt, amely a tábla szélességéből és magasságából, továbbá a kapott bombák listájából előállítja a teljes táblát, amin játszani fogunk. Amelyik mezőn bomba szerepel, arra a helyre nyilván a <code>Mine</code> érték kerül, más helyekre pedig a <code>Free</code>-vel jelölt <code>FieldNumber</code> típusú szám. A <code>FieldNumber</code> típus a <code>MineSweeper.FieldNumber</code> modulban található. Fontos, hogy a játék kezdetén az összes mező zárt állapotú. Feltehető, hogy a listában a megadott bombák mindig a táblán helyezkednek el.</p>
<pre class="hljs"><code><div><span class="hljs-title">case</span> generateBoard <span class="hljs-number">10</span> <span class="hljs-number">10</span> [(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">7</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">5</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">5</span>)] <span class="hljs-keyword">of</span> <span class="hljs-type">Board</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> [[<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)]] -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> generateBoard <span class="hljs-number">10</span> <span class="hljs-number">10</span> [(<span class="hljs-number">0</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>),(<span class="hljs-number">4</span>,<span class="hljs-number">3</span>),(<span class="hljs-number">5</span>,<span class="hljs-number">1</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">7</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">6</span>),(<span class="hljs-number">8</span>,<span class="hljs-number">8</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">4</span>),(<span class="hljs-number">9</span>,<span class="hljs-number">7</span>)] <span class="hljs-keyword">of</span> <span class="hljs-type">Board</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> [[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">4</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)]] -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
</div></code></pre>
<h2 id="10-j%C3%A1t%C3%A9k-kezd%C5%91%C3%A1llapota">10. Játék kezdőállapota</h2>
<p>Definiáljuk a <code>startNewGame :: Width -&gt; Height -&gt; NumberOfBombs -&gt; Seed -&gt; Game</code> függvényt, amely előállítja egy játéknak a kezdőállapotát a megadott paramétereknek megfelelően. Szükséges a tábla szélessége, magassága, a bombák száma és egy &quot;játékszám&quot;, tehát a <code>Seed</code>, amiből generáljuk a random elemeket. A játék kezdetén az összes mező zárt állapotú, ezt a <code>generateBoard</code> függvény megoldja. A játék állapota legyen futó, tehát <code>Running</code>.</p>
<pre class="hljs"><code><div><span class="hljs-title">case</span> startNewGame <span class="hljs-number">5</span> <span class="hljs-number">5</span> <span class="hljs-number">10</span> <span class="hljs-number">40</span> <span class="hljs-keyword">of</span> <span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">5</span> [[<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">5</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)],[<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">4</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">4</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)]]) <span class="hljs-type">Running</span> -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> startNewGame <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> <span class="hljs-number">40</span> <span class="hljs-keyword">of</span> <span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">10</span> <span class="hljs-number">10</span> [[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">4</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)]]) <span class="hljs-type">Running</span> -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> startNewGame <span class="hljs-number">15</span> <span class="hljs-number">5</span> <span class="hljs-number">20</span> <span class="hljs-number">2347832478</span> <span class="hljs-keyword">of</span> <span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">15</span> <span class="hljs-number">5</span> [[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">4</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">5</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)]]) <span class="hljs-type">Running</span> -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
</div></code></pre>
<h2 id="11a-elemek-cser%C3%A9je">11a. Elemek cseréje</h2>
<p>Definiáljuk a <code>replaceAt :: Int -&gt; a -&gt; [a] -&gt; [a]</code> függvényt, amely egy listában egy adott helyen lévő elemet lecserél egy másikra.</p>
<pre class="hljs"><code><div><span class="hljs-title">replaceAt</span> <span class="hljs-number">1</span> 'a' <span class="hljs-string">"Hello"</span> == <span class="hljs-string">"Hallo"</span>
<span class="hljs-title">replaceAt</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> [<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>] == [<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]
<span class="hljs-title">replaceAt</span> <span class="hljs-number">2</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>] [[<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]] == [[<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]]
<span class="hljs-title">replaceAt</span> <span class="hljs-number">3</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>) [<span class="hljs-type">Mine</span>, <span class="hljs-type">Mine</span>, <span class="hljs-type">Free</span> <span class="hljs-number">0</span>, <span class="hljs-type">Free</span> <span class="hljs-number">4</span>, <span class="hljs-type">Free</span> <span class="hljs-number">5</span>, <span class="hljs-type">Mine</span>] == [<span class="hljs-type">Mine</span>, <span class="hljs-type">Mine</span>, <span class="hljs-type">Free</span> <span class="hljs-number">0</span>, <span class="hljs-type">Free</span> <span class="hljs-number">1</span>, <span class="hljs-type">Free</span> <span class="hljs-number">5</span>, <span class="hljs-type">Mine</span>]
</div></code></pre>
<h2 id="11b-elemek-cser%C3%A9je-list%C3%A1k-list%C3%A1j%C3%A1ban">11b. Elemek cseréje listák listájában</h2>
<p>Definiáljuk a <code>replaceAtMatrix :: (Int, Int) -&gt; a -&gt; [[a]] -&gt; [[a]]</code> függvényt, amely egy listák listájában egy adott helyen lévő elemet lecserél egy másikra. Az első index a lista sorszámát, a második az elem sorszámát adja meg.</p>
<pre class="hljs"><code><div><span class="hljs-title">replaceAtMatrix</span> (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) 'a' [<span class="hljs-string">"elma"</span>, <span class="hljs-string">"barack"</span>, <span class="hljs-string">"szilva"</span>] == [<span class="hljs-string">"alma"</span>, <span class="hljs-string">"barack"</span>, <span class="hljs-string">"szilva"</span>]
<span class="hljs-title">replaceAtMatrix</span> (<span class="hljs-number">2</span>,<span class="hljs-number">5</span>) <span class="hljs-number">100</span> [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>], [<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>], [<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>], [<span class="hljs-number">21</span>,<span class="hljs-number">22</span>],[<span class="hljs-number">23</span>,<span class="hljs-number">24</span>,<span class="hljs-number">25</span>,<span class="hljs-number">26</span>]] == [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>], [<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>], [<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">100</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>], [<span class="hljs-number">21</span>,<span class="hljs-number">22</span>],[<span class="hljs-number">23</span>,<span class="hljs-number">24</span>,<span class="hljs-number">25</span>,<span class="hljs-number">26</span>]]
<span class="hljs-title">replaceAtMatrix</span> (<span class="hljs-number">4</span>,<span class="hljs-number">3</span>) <span class="hljs-type">Mine</span> [[<span class="hljs-type">Free</span> <span class="hljs-number">1</span>], [], [<span class="hljs-type">Free</span> <span class="hljs-number">3</span>, <span class="hljs-type">Free</span> <span class="hljs-number">4</span>, <span class="hljs-type">Free</span> <span class="hljs-number">2</span>, <span class="hljs-type">Mine</span>, <span class="hljs-type">Mine</span>, <span class="hljs-type">Free</span> <span class="hljs-number">1</span>], [<span class="hljs-type">Mine</span>, <span class="hljs-type">Free</span> <span class="hljs-number">5</span>, <span class="hljs-type">Free</span> <span class="hljs-number">4</span>], [<span class="hljs-type">Free</span> <span class="hljs-number">0</span>, <span class="hljs-type">Free</span> <span class="hljs-number">0</span>, <span class="hljs-type">Free</span> <span class="hljs-number">2</span>, <span class="hljs-type">Free</span> <span class="hljs-number">3</span>]] == [[<span class="hljs-type">Free</span> <span class="hljs-number">1</span>], [], [<span class="hljs-type">Free</span> <span class="hljs-number">3</span>, <span class="hljs-type">Free</span> <span class="hljs-number">4</span>, <span class="hljs-type">Free</span> <span class="hljs-number">2</span>, <span class="hljs-type">Mine</span>, <span class="hljs-type">Mine</span>, <span class="hljs-type">Free</span> <span class="hljs-number">1</span>], [<span class="hljs-type">Mine</span>, <span class="hljs-type">Free</span> <span class="hljs-number">5</span>, <span class="hljs-type">Free</span> <span class="hljs-number">4</span>], [<span class="hljs-type">Free</span> <span class="hljs-number">0</span>, <span class="hljs-type">Free</span> <span class="hljs-number">0</span>, <span class="hljs-type">Free</span> <span class="hljs-number">2</span>, <span class="hljs-type">Mine</span>]]
</div></code></pre>
<h2 id="12-egy-mez%C5%91-kinyit%C3%A1sa">12. Egy mező kinyitása</h2>
<p>Definiáljuk az <code>openField :: Field -&gt; Field</code> függvényt, amely segítségével egy mezőt ki lehet nyitni. Tehát ha <code>Closed</code> állapotú a mező, akkor legyen <code>Opened</code>. Zászlózott mezőt nem lehet kinyitni, illetve a nyitott mező már nyitva van, így azokban az esetekben adjuk vissza önmagát a mezőt.</p>
<pre class="hljs"><code><div><span class="hljs-title">case</span> openField (<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)) <span class="hljs-keyword">of</span> <span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> openField (<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>) <span class="hljs-keyword">of</span> <span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span> -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> openField (<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)) <span class="hljs-keyword">of</span> <span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> openField (<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)) <span class="hljs-keyword">of</span> <span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
</div></code></pre>
<h2 id="13-mez%C5%91-kinyit%C3%A1sa-a-t%C3%A1bl%C3%A1n">13. Mező kinyitása a táblán</h2>
<p><strong>FIGYELEM! Nem triviális ezt megoldani, ne maradjon ez a végére!</strong><br>
Definiáljuk az <code>openTile :: Game -&gt; (Int, Int) -&gt; Game</code> függvényt, amely egy játékállapotot és egy adott mezőt kapva visszaad egy új játékállapotot. Ha minden szabályosan történik, tehát az index valóban a táblára mutat, zárt mezőt szeretnénk kinyitni és fut a játék, akkor kinyitja azt a mezőt. Figyelni kell arra, hogy ha a mező 0-ás számot takar, akkor a szomszédos mezőket is szintén ki kell nyitni. Ha egy adott számú már nyitott mezőt szeretnénk nyitni, akkor ellenőrizzük, hogy a körülötte lévő zászlók száma megegyezik-e a mezőn található számmal. Ha egyezik, akkor nyissuk ki a körülötte lévő összes zárt mezőt. Ha valami szabálytalanság történik vagy a játék <code>GameOver</code> állapotban van, akkor a játékállapot nem változik.</p>
<p><em>Segítség:</em> A függvényben kell arra figyelni, hogy mi történik akkor, ha 0-át nyitunk, illetve ha nem 0-át nyitunk. Ehhez szükségünk lesz két segédfüggvényre, amelyeknek a típusa megegyezik az <code>openTile</code> típusával. Az egyik kezeli azt, amikor csak egy mezőt kell kinyitni és nem többet. A másik fogja kezelni azt, amikor több mezőt kell kinyitni, akár a 0-ák, akár egy nyitott mezőre való kattintáskor.</p>
<p><em>Első segédfüggvény:</em></p>
<p>Ha nem 0-át nyitunk:</p>
<ul>
<li>Nyissuk ki azt az adott zárt mezőt. Fontos, hogy zárt legyen kezdetben, mert az <code>openField</code> nem tudja belülről detektálni, hogy mikor kell egy külső függvénynek végeznie.</li>
<li>Építsük fel a <code>Game</code> értékét úgy, hogy abban már kinyitjuk ezt az adott mezőt.</li>
<li>A függvény működése álljon le, tehát nem kell se rekurzió, se más.</li>
</ul>
<p>Ha 0-át nyitunk:</p>
<ul>
<li>Nyissuk ki azt az adott zárt mezőt. Fontos, hogy zárt legyen kezdetben, mert az <code>openField</code> nem tudja belülről detektálni, hogy mikor kell egy külső függvénynek végeznie.</li>
<li>Építsük fel a <code>Game</code> értékét úgy, hogy abban már kinyitjuk ezt az adott mezőt.</li>
<li>Lépjünk át a másik segédfüggvénybe, amelyben kinyitjuk a 0-ának a szomszédait. Az előbb felépített <code>Game</code> értéket adjuk tovább annak.</li>
</ul>
<p><em>Másik segédfüggvény:</em></p>
<ul>
<li>Hívjuk meg az első segédfüggvényt a szomszédos indexekkel.</li>
<li>Szükséges a táblát folyamatosan szükséges frissíteni, így talán ezt a legegyszerűbb hajtogatással megoldani. Hogy melyik irányú hajtogatás kell, annak a meghatározásában segít a típus.</li>
</ul>
<p>Ha zárt mezőt nyitunk ki, akkor az <code>openTile</code>-ból az első segédfüggvényt kell meghívni. Ha pedig nyitottat próbálunk még egyszer kinyitni, tehát azon mező szomszédait szeretnénk kinyitni, akkor a másik segédfüggvényt kell meghívni.</p>
<pre class="hljs"><code><div><span class="hljs-comment">-- 0-ás mező</span>
<span class="hljs-title">case</span> openTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">3</span>,<span class="hljs-number">4</span>) <span class="hljs-keyword">of</span> <span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span> -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- bombás mező</span>
<span class="hljs-title">case</span> openTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">0</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- game over</span>
<span class="hljs-title">case</span> openTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) (<span class="hljs-type">GameOver</span> <span class="hljs-type">False</span>)) (<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) (<span class="hljs-type">GameOver</span> <span class="hljs-type">False</span>)) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- már nyitott mező</span>
<span class="hljs-title">case</span> openTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- zászlós mező</span>
<span class="hljs-title">case</span> openTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Flagged</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">1</span>,<span class="hljs-number">4</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Flagged</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- zászlós szomszéd</span>
<span class="hljs-title">case</span> openTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Flagged</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">2</span>,<span class="hljs-number">4</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Flagged</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
</div></code></pre>
<h2 id="14-mez%C5%91-z%C3%A1szl%C3%B3z%C3%A1sa">14. Mező zászlózása</h2>
<p>Definiáljuk a <code>flag :: Field -&gt; Field</code> függvényt, amellyel egy zárt mezőre zászlót lehet helyezni, egy zászlós mezőről pedig azt levenni. Nyitott mezőt ez nem befolyásolja, az maradjon ugyanaz.</p>
<pre class="hljs"><code><div><span class="hljs-title">case</span> flag (<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)) <span class="hljs-keyword">of</span> <span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> flag (<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)) <span class="hljs-keyword">of</span> <span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> flag (<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)) <span class="hljs-keyword">of</span> <span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> flag (<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>) <span class="hljs-keyword">of</span> <span class="hljs-type">Flagged</span> <span class="hljs-type">Mine</span> -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-title">case</span> flag (<span class="hljs-type">Flagged</span> <span class="hljs-type">Mine</span>) <span class="hljs-keyword">of</span> <span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span> -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
</div></code></pre>
<h2 id="15-mez%C5%91-z%C3%A1szl%C3%B3z%C3%A1sa-a-t%C3%A1bl%C3%A1n">15. Mező zászlózása a táblán</h2>
<p>Definiáljuk a <code>flagTile :: Game -&gt; (Int, Int) -&gt; Game</code> függvényt, amely egy játékállapotot és egy helyet kap paraméterül. Ha a játék fut, akkor tegyünk zászlót a megadott mezőre vagy vegyük azt onnan le. Szabálytalan esetben ne változtassunk a játékállapoton.</p>
<pre class="hljs"><code><div><span class="hljs-comment">-- game over</span>
<span class="hljs-title">case</span> flagTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) (<span class="hljs-type">GameOver</span> <span class="hljs-type">False</span>)) (<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) (<span class="hljs-type">GameOver</span> <span class="hljs-type">False</span>)) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- zárt mező zászlózása</span>
<span class="hljs-title">case</span> flagTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- zászló levétele</span>
<span class="hljs-title">case</span> flagTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
<span class="hljs-comment">-- nyitott mező</span>
<span class="hljs-title">case</span> flagTile (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) (<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">of</span> (<span class="hljs-type">Game</span> (<span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]) <span class="hljs-type">Running</span>) -&gt; <span class="hljs-type">True</span>; _ -&gt; <span class="hljs-type">False</span>
</div></code></pre>
<h2 id="16-nyitott-bomb%C3%A1s-mez%C5%91k-keres%C3%A9se">16. Nyitott bombás mezők keresése</h2>
<p>Definiáljuk a <code>checkOpenedBomb :: Board -&gt; Bool</code> függvényt, amely meghatározza, hogy van-e nyitott bombás mező a táblán.</p>
<pre class="hljs"><code><div><span class="hljs-title">not</span> $ checkOpenedBomb $ <span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]
<span class="hljs-title">not</span> $ checkOpenedBomb $ <span class="hljs-type">Board</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> [[<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]
<span class="hljs-title">checkOpenedBomb</span> $ <span class="hljs-type">Board</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> [[<span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span>]]
<span class="hljs-title">checkOpenedBomb</span> $ <span class="hljs-type">Board</span> <span class="hljs-number">5</span> <span class="hljs-number">7</span> [[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Flagged</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">3</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>)],[<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">0</span>),<span class="hljs-type">Opened</span> (<span class="hljs-type">Free</span> <span class="hljs-number">1</span>),<span class="hljs-type">Opened</span> <span class="hljs-type">Mine</span>,<span class="hljs-type">Closed</span> (<span class="hljs-type">Free</span> <span class="hljs-number">2</span>),<span class="hljs-type">Closed</span> <span class="hljs-type">Mine</span>]]
</div></code></pre>
<h2 id="17-j%C3%A1t%C3%A9k-v%C3%A9ge">17. Játék vége</h2>
<p>Definiáljuk a <code>checkGameOver :: Game -&gt; Game</code> függvényt. A játéknak kétféleképpen lehet vége. Vagy kinyitottuk az összes nem bomba mezőt vagy bombát nyitottunk. Előbbi esetben a játékos nyert, ezt a <code>GameOver</code> konstruktornak átadott <code>True</code> értékkel kell jelezni. Ha a játékos bombát nyitott, akkor jelenítsük meg az összes bombát, hogy hol voltak. Az egyszerűség kedvéért a zászlósakat is nyissuk ki ebben az esetben. Azzal nem kell foglalkozni, hogy zászló volt olyan helyen, ahol nem volt bomba.</p>
<h2 id="18-l%C3%A9p%C3%A9s-t%C3%ADpusa">18. Lépés típusa</h2>
<p>Definiáljunk egy saját típust <code>MoveType</code> néven, amelynek legyen két konstruktora:</p>
<ul>
<li><code>Flag :: (Int, Int) -&gt; MoveType</code>, ez a konstruktor mondja meg, hogy mi zászlót szeretnénk helyezni a táblára.</li>
<li><code>Open :: (Int, Int) -&gt; MoveType</code>, ez a konstruktor mondja meg, hogy mi ki szeretnénk nyitni az adott mezőt.</li>
</ul>
<h2 id="19-egy-l%C3%A9p%C3%A9s-a-j%C3%A1t%C3%A9kban">19. Egy lépés a játékban</h2>
<p>Definiáljuk a <code>stepGame :: Game -&gt; MoveType -&gt; Game</code> függvényt, amellyel egyet lépünk a játékban. Kap egy játékállapotot és egy indexet, hogy melyik mezővel szeretnénk akciót végezni. Ha <code>Flag</code>, akkor zászlót szeretnénk lehelyezni. Ha <code>Open</code>, akkor mezőt szeretnénk nyitni. Végül szükséges ellenőrizni, hogy a játéknak vége van-e.</p>

</body>
</html>
