Bónusz feladat: Lucas-sorozat gyorsítása
Kategória:	Házi feladatok
Elérhető:	2022. 11. 26. 0:00
Pótolható határidő:
Végső határidő:	2022. 12. 16. 23:59
Maximum beküldési próbálkozások száma:	Korlátlan
Kiírta:	Bense Viktor

Leírás:
Lucas-sorozat még jobban
0. Modul
Definiálj egy modult FastLucas néven!

A html fájlban jobban látszódnak a képletek!

1. Saját típus
Készíts egy saját típust, amellyel még gyorsabban lehet kiszámolni a Lucas-sorozat elemeit.

Az ötlet, hogy a közvetlen képletet gyorsabb használni, mint lineárisan egyesével ellépkedni az n. elemig. Az sqrt függvény azonban nagyon pontatlan, egyébként is a sorozat elemei a rekurzív definíció alapján kitalálható, hogy csak egészek lehetnek. A közvetlen képlet a következő, hasonló a Fibonacci-sorozatéhoz:

ϕ
=
1
+
5
2
ϕ= 
2
1+ 
5
​
 
​
 

L
n
=
ϕ
n
+
(
1
−
ϕ
)
n
L 
n
​
 =ϕ 
n
 +(1−ϕ) 
n
 

A számolások során használd a lehető legpontosabb számtípust, az Integer-t vagy a Rational-t, amely típus a Data.Ratio modulban található meg. A Rational típus két egész szám hányadosát reprezentálja.

Segítség: A komplex számokat például a data Complex = Complex Rational Rational-lal el lehet kódolni, ahol az első paraméter a valós rész, a második paraméter a képzetes rész. Most is valami hasonlót kell csinálni. A képletből látható, hogy csak 
5
5
​
  -tel kell foglalkozni, más irracionális számmal nem, ezt érdemes kihasználni. Az is tudható, hogy az eredmény mindig egész lesz, ezt is ki lehet használni majd a lucas definiálásában.

Rational használata: Három fontosabb függvénye van:

(%) :: Integer -> Integer -> Rational: Lehet vele definiálni Rational típusú értéket két Integer megadásával.
numerator :: Rational -> Integer: Visszaadja a tört számlálóját.
denominator :: Rational -> Integer: Visszaadja a tört nevezőjét.
2. Példányok a típusra
A fordító segítségét kérve legyen egy Show példányunk.
Készíts egy saját Num példányt az előzőleg megírt saját típusra a matematikának megfelelően! A signum függvényt elég megadni a hagyományos számolással, teljesen pontos eredményt nehéz összerakni belőle.
Emlékeztető: Saját példányt az instance ... where konstrukcióval csináltunk.

3. Aranymetszés / golden ratio
Definiáld a phi konstanst, amely a saját típusodban az aranymetszés értékét, azaz 
ϕ
=
1
+
5
2
ϕ= 
2
1+ 
5
​
 
​
  értékét kódolja el.

4. Lucas-sorozat n. eleme
A feladat ugyanaz, mint a korábbiakban volt, a Lucas-sorozat n. elemét kell visszaadni az értelmes legáltalánosabb típussal. A függvény megint legyen a régi formának megfelelően egyparaméteres.
A függvény neve ugyanúgy lucas :: (Integral a, Num b) => a -> b.
Ha minden jól lett definiálva, akkor a 10 000 000. elemig semmilyen probléma nem lesz, így ez az elvárás, hogy a 10 000 000. elemet is 1 másodpercen belül ki tudja értékelni a tesztelő.

5. Lucas-sorozat felhasználása
Definiáld a már ismert isNotPrime :: Integral a => a -> Bool függvényt, amely a Lucas-sorozat segítségével meghatározza egy számról, hogy biztosan nem prímszám-e.

A felhasználási módja a következő:

Legyen a vizsgált számunk n, erre vagyunk kíváncsiak, hogy prímszám-e. Vegyük a Lucas-sorozat n. elemét (a sorozat elemeit 0-tól számozva), az ott szereplő számból vonjunk ki 1-et. Ha az úgy kapott szám n-nek nem a többszöröse, akkor n teljesen biztosan nem prímszám (ekkor adjon vissza a függvény True értéket). Ha az úgy kapott szám n-nek többszöröse, akkor nem tudunk a számról semmi biztosat állítani, ekkor a függvény adjon vissza False értéket.

Tesztesetek
lucas 30 == 1860498
lucas 50 == 28143753123
lucas 100 == 792070839848372253127
lucas 1000 == 97194177735908175207981982079326473737797879155345685082728081084772518818444815269080619149045968297679578305403209347401163036907660573971740862463751801641201490284097309096322681531675707666695323797578127
lucas 50000 == 2409974786438259888049806980633449949826411636815319968037733751953933768251364871646600182223185096209004576744311063458687656435390814983002059173545163749165114521481963055924642777476345606353147245996524152191062303288387127388777091373584370507443894651940437009777277200511306077396570143305141680231810102956572225207191820054607922245622445171999709442402736304403902351040121418794171207833087656214349588478417161401107584194013911284065713148495060887015800537210164801723748906950147939419958924224730612583366913789947009593666482836585451592509542615521427829415817650319996324171171201732811397479247966352367086507054250009117152952832172564516009145677541201213853733497579808218662733309063033919417191063570178091370334876591052410694175332894395500042644666855224396449676900792803475395956024004761782856931139516608385716469865961202431982793509561925473528747798860615722041131642096486163676194318870967536904646900506794198502625329960618225108752205304831156909747219940901777705510494118177421257037039108820490047496882787084704602849413141998099739903777777841432239365170569028843727246505006123188831438586997580581957287350142584629108857445067944299095371789389223815398931211312655960581733206068245023988976837622423046264693822684262651140869892638144607359916166663314469440481645491506377187677691371166866209586372062047254915615264732233996079032850548339753493570534976558713895823345494764109034946356613211252771435563225526274395180392437282460117140212011122589416451051930094692605881091909687196554874291755498125684068677603699857778514220971421754211851446339019023765138399777366359209085184692864889662621492995869224817340420046060998057906074555683885678140849466214494057839595107942503215241658118025525846976568347321386331927005098056467151192629608865133312619872566694928594790607809816802673557037222044960716656741803290117415940897508713892377098320210899444835329697993694045952071101960714276774171006664140482310470542963477569789077745634764015821900914345409849538895154561883051138687765746953966979105002635998304374572018193863906652279870606641460614795465351283531598764788633836831067970578056095782151435518136315575174275632717781322803333436909397875702409094900783971317894232509912254257193319896542543091125581365531640944242025060416757661025215627745830466593261098900157490481018122155636297172090927149125954477051773813884261308923041353384378872261116442416667913966785205624172229842973951857298200282348949255251554118947178388364027212693869247909785293607857792298389649732347060793014631655866844856515955879087825409199966337902219977356281288523582876481104362038904241353824137238663999791982605381567697730898591863381323825024454552926256786725113724769383034008479764089737391328377993900126074878835857073047094820362795265870608611282982628450836330374112164757703463572903636686588058292365186613279625439056401282283207394973869033086301453579762785196709649237675325428110545354366383338341637314256767097067566590926006315927120960967989889522204138283594464386914036314010078053129672244457628820957223079235724076691733894904326759675817581111710421444869155362965849762528879317926908704693069321902308816843204668236514777411873514503192481851582819746024853694774830910693836873499771184480055124931583522940791727823329945259579797313919475267654487832376426924731529541637666285969735025753333493592379210218338436039416511671237734494888101493050025857016436551635692937249020386631628175174390271600120115457470808122384628469631675734045117340603567046162444795020455128152360293908296711775137658488428425158304258079897395299621231122467443453130817269246619157127482004729917472965394297378226343713624370423484158586531687449799835416699808193531569720010648888725313490647469544655167909984411750535275957199658287706168561304069978704287510299784133598380531672097518272106894414234904934958425714531972881260516834064838666400117090660381876171211380122651735354970816604905910643783745145278303280894137867070324537970382592554567332106190842662074688270500431398979845300325516245210124712080290300895805130510644482425987294746308824075181035124559775889768332721948999018686308025493781574870886509547388888973196135832146539319983212105081851084493648496595623879063673108644372261949313327795557540245206406872690935314317703724632629915662463568930617343897698024147978598256748508839981442100527053517175557035788708044432169417459600493011710356612987510397475954792509493190321508048943678032697031767379618615647411638321004793806293724334962916617790002502463809592288550579731087655820988789844788674119157959890092734816144964302207601704232637772821903509239482249141680974724199784674097980805700258308995271608448943346681576052049365396378688183046026265157441962433029849281059173871344837518648732277190790682822659720198601257632921350015021797326997394578317653690200479376068865214139771200351184453521402292951949038341710475725757684732739872859000162824683401894574615042665278437279626791094042085078585315671253004635304279420068400382327682798651570630769081398546671819016146638407901224856631438484681915567607461516413830890960398235574718903101209127893855445649478097449424629194454625919585276482485759680791390111408670177816084029852480991885749683870500094508322991170325438045502170097866857978920132354567698696997053087086295809634567959532455673894044897109318532246548989276057102239950672130377289791822081935834543316765474520780317324753921508388411850876735839364070500956532930063969578651179073131788964485772788793784028364460475705738419903964698513717619624808495692173347986089608951949191992263806513081666755055190122493333794480990234749300748993852359040751639410163074219004594137459634106638898615616698122667962813094849610472235374221218004737199366403875494034545222318184095078139998249349941093010915762817167583094917129185639800846126302473142580495065690390501571402225976700877919355957653768602505961050740755507739673997899891688850486778409711365230746612866895498434018835213126103045541644022965084635229168145272784118586269270310225640188886610871669136892492300201528431575639564167749098869769741055415736110701035233152535700656516033774576880671369037594078799217382024993479179869868703885907583643824419107845235182043598538183130532579744599158952831437632833843339083389042382291668607366898234286925716087699798173943723409122164106435614822841498305296769359477148841837242009489337717822609756906796234763324728050069531546248382298903697693972813682373373232310746292916624686526805228556304872581270368089766487538870336658036828192280558199481634377998540040523667598787708370957218704511558421289849586657335192889762074323896572374501898092028530082561536123361721037672098298484669930339342376025820320478478253628488236145763071353887130207668520883938238538432184158878519889407300646228880473961008650349514343580970851413422770090179637949634955728775231329321060293114558940973606736475595155536212687766225843829273163724992145355999419583492399376228559242921424580864430903406053028936357002662772773721786980214655789384190012892096353918082795216924019349278577733363291009139574729858489735703480038068127958542625332945324976766319485279498425634639824790407108752075050211895623765696484786139008255571066525854820372881889256033122983155063850803349932738351507664439546491238077164211025496851764996900236155002647107619696688774580165888708042773511188688686605324837319228669919763073205622584999721942071232069059286325926086708816051610852107520690940368155204457089404625483258380195218547384426895351792982664875695337752956723684845795061756672981117210810579041960863955313014641232559546387244620971192286528977528181324725203814193858145343615674377024378856787501153857619484718725979599172516213122966204992846810899525433321044750802917598053067488463922185069811496747699088889175993415765920835730515132328266292416206889376445564258929588824542389369184316501744814602600306940268907498531055811818113004015339278125699125550750398442009183752420180761402570670688595989136925624468003030562460011698742300730863567054909397656905211231868968211242234003388967549039746366992141840743025269622194952494916110207166445369031491655921421348884315152385194874078388288679221251974609364287850215431677133305701286756754460275230307867995068435136509541968144752145353308192593505961974496750009692395484597431713248689908624232718452719572988612612711339331500190372858629341344583454294803788547267153377704456876478932472660205457505024605499348029092199435235956377358532053933931168410220091633987125325087070117400987319284325970149590012043128257219076430619452738059204078726543475252795012329593819687470088156439455569149306218811525677454070988190388303027890806087052340917918565747032241774311729618873957034162681846535653251331431266667788505485175265454072649968908390587412231837232656167390773594497756624303716156142836724323321581356182647763198472747594427619946227184019228566402638215019939513671276695686951099715093977087863090759657754537710840255225639019230612418684741868788401551993158651829269774732972039524143568501002969817943870279281122242077373817718496907932097951278906488370706612195680891363805511429773836966905272974743343717576740219530241575034937541985674593912988599508630615298623568424796632472176363146255643446730256252034924791901312466029156593570617895473567296753829201850267101110252708422625371841372836235076934689672824940331074116108014225135481561957041306017767091781162038173650704375026192871486911646071356251349080087488881601978980753751296684979958805707190825845576224299249790314969242098663021862786050198230978192203910390840718441845966638228332217000835565828287227015953446784654982713570227358528877695454828200594702799161831860750193524822051408079324909510924390086068514025961004167597685905725461159954348182869036716134669357787335451303853754125142535163853280990150722219518654804814476097099894015845658015154189569451843385762269784701582661474517753894669269127187656967680389243756957868125520854955331132160630466788202141474776398570811546171281571927567897287721637722328920092481271460388343499252503982093176674513189229138790215020948833055571067913487617916151992398720643179426615094367870410111111539482181439009527753612935111955305100855756145699421527909958163722807295737341840062815779706722928315750048828127
lucas 500000 == lucas 500000
isNotPrime 4
isNotPrime 6
not (isNotPrime 7)
not (isNotPrime 11)
not (isNotPrime 17)
not (isNotPrime 23)
isNotPrime 230
not (isNotPrime 705) -- ez az első olyan szám, ami ezen a teszten átmegy, mint összetett szám, eddig a pontig igaz, hogy ami átmegy a teszten az prím, ami megbukik, az összetett.
isNotPrime 1000